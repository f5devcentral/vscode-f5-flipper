#NS13.1 Build 37.38
# Last modified by `save config`, Mon May 03 12:34:56 2555

# ANY Protocol Load Balancer Configuration
# Example: Transparent multi-protocol load balancer for Exchange servers

# ANY Protocol Virtual Server - Passes through all IP protocols transparently
add lb vserver exchange_any_vs ANY 192.168.1.41 * -persistenceType NONE -lbMethod ROUNDROBIN -backupLBMethod SOURCEIPHASH -cltTimeout 900

# Service Group for ANY Protocol
add serviceGroup exchange_any_sg ANY -maxClient 0 -maxReq 0 -cip DISABLED -usip NO -useproxyport NO -cltTimeout 900 -svrTimeout 900 -CKA NO -TCPB NO -CMP NO

# Bind service group to virtual server
bind lb vserver exchange_any_vs exchange_any_sg

# Primary Site Exchange Servers (Site A)
bind serviceGroup exchange_any_sg exchange_sitea_01 *
add server exchange_sitea_01 10.1.1.223 -comment "Primary Exchange Server Site A"

bind serviceGroup exchange_any_sg exchange_sitea_02 *
add server exchange_sitea_02 10.1.1.98 -comment "Secondary Exchange Server Site A"

# Secondary Site Exchange Servers (Site B)
bind serviceGroup exchange_any_sg exchange_siteb_01 *
add server exchange_siteb_01 10.2.1.212 -comment "Primary Exchange Server Site B"

bind serviceGroup exchange_any_sg exchange_siteb_02 *
add server exchange_siteb_02 10.2.1.211 -comment "Secondary Exchange Server Site B"

# Additional Exchange Servers (High Availability)
bind serviceGroup exchange_any_sg exchange_siteb_ha1 *
add server exchange_siteb_ha1 10.2.1.218 -comment "HA Exchange Server Site B"

bind serviceGroup exchange_any_sg exchange_siteb_ha2 *
add server exchange_siteb_ha2 10.2.1.219 -comment "HA Exchange Server Site B"

bind serviceGroup exchange_any_sg exchange_sitea_ha1 *
add server exchange_sitea_ha1 10.1.1.33 -comment "HA Exchange Server Site A"

bind serviceGroup exchange_any_sg exchange_sitea_ha2 *
add server exchange_sitea_ha2 10.1.1.154 -comment "HA Exchange Server Site A"

# Health Monitor - Basic ping for ANY protocol
bind serviceGroup exchange_any_sg -monitorName ping
